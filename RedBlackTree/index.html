<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="You can find the original writing in this GitHub Repo  Monologue I remember when the first time I studied Red Black Tree (RBT) , it was an enigma . A seemingly random rotations and colorings seems to">
<meta property="og:type" content="article">
<meta property="og:title" content="Red Black Tree : An Intuitive Approach (A Deep Dive)">
<meta property="og:url" content="https://zarif98sjs.github.io/dummy/RedBlackTree/index.html">
<meta property="og:site_name" content="MindCraft">
<meta property="og:description" content="You can find the original writing in this GitHub Repo  Monologue I remember when the first time I studied Red Black Tree (RBT) , it was an enigma . A seemingly random rotations and colorings seems to">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/Pikachu.webp">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModBST.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModInsert1.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModInsert2.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModInsert3.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModInsert4.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModInsert6.PNG">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModInsert7.PNG">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModInsert8.PNG">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/ModInsert9.PNG">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/DoubleModInsert1.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/DoubleModInsert2.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/DoubleModInsert3.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/DoubleModInsert4.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/GlueEdge1.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/GlueEdge2.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/GlueEdge3.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/meme.jpg">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/RBTInsert1.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/RBTInsert2.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/RBTInsert4.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/RBTInsert5.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/RBTInsert6.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/RBTInsert7.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/Delete1.png">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/Delete2.PNG">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/Delete3.PNG">
<meta property="og:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/Delete4.PNG">
<meta property="article:published_time" content="2020-07-05T00:00:00.000Z">
<meta property="article:modified_time" content="2021-04-26T14:47:16.828Z">
<meta property="article:author" content="Md. Zarif Ul Alam">
<meta property="article:tag" content="Algo, DS, Software &amp; What Not!">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zarif98sjs.github.io/images/RBTDrawings/Images/Pikachu.webp">
    
    
      
        
          <link rel="shortcut icon" href="/dummy/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/dummy/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/dummy/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Red Black Tree : An Intuitive Approach (A Deep Dive)</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/dummy/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/dummy/">Home</a></li>
         
          <li><a href="/dummy/archives/">Archive</a></li>
         
          <li><a href="https://zarif98sjs.github.io/">About Me</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post " href="/dummy/LinuxCommands/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post " href="/dummy/MaxFlow/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zarif98sjs.github.io/dummy/RedBlackTree/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&text=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&is_video=false&description=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Red Black Tree : An Intuitive Approach (A Deep Dive)&body=Check out this article: https://zarif98sjs.github.io/dummy/RedBlackTree/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&name=Red Black Tree : An Intuitive Approach (A Deep Dive)&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zarif98sjs.github.io/dummy/RedBlackTree/&t=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Monologue"><span class="toc-number">1.</span> <span class="toc-text">Monologue</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Story-Begins"><span class="toc-number">2.</span> <span class="toc-text">The Story Begins</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A-slightly-modified-BST"><span class="toc-number">2.1.</span> <span class="toc-text">A slightly modified BST</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Key-Takeaway-from-slightly-modified-BST"><span class="toc-number">2.1.1.</span> <span class="toc-text">Key Takeaway from slightly modified BST</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Modifying-one-step-further"><span class="toc-number">2.2.</span> <span class="toc-text">Modifying one step further</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Changing-Vantage-Point"><span class="toc-number">3.</span> <span class="toc-text">Changing Vantage Point</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Inside-the-Black-Box"><span class="toc-number">4.</span> <span class="toc-text">Inside the Black Box</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Insert"><span class="toc-number">4.1.</span> <span class="toc-text">Insert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Delete"><span class="toc-number">4.2.</span> <span class="toc-text">Delete</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Getting-our-hands-dirty-with-code"><span class="toc-number">5.</span> <span class="toc-text">Getting our hands dirty (with code)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Node"><span class="toc-number">5.1.</span> <span class="toc-text">The Node</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Auxiliary-Operations"><span class="toc-number">5.2.</span> <span class="toc-text">Auxiliary Operations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Insert-1"><span class="toc-number">5.3.</span> <span class="toc-text">Insert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Delete-1"><span class="toc-number">5.4.</span> <span class="toc-text">Delete</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Optimization-and-Conclusion"><span class="toc-number">6.</span> <span class="toc-text">Optimization and Conclusion</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">7.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Red Black Tree : An Intuitive Approach (A Deep Dive)
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Md. Zarif Ul Alam</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-07-05T00:00:00.000Z" itemprop="datePublished">2020-07-05</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/dummy/categories/Data-Structure/">Data Structure</a> › <a class="category-link" href="/dummy/categories/Data-Structure/Deep-Dive/">Deep Dive</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/dummy/tags/Algo-DS-Software-What-Not/" rel="tag">Algo, DS, Software & What Not!</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p><strong>You can find the <code>original writing</code> in this <a target="_blank" rel="noopener" href="https://github.com/zarif98sjs/RedBlackTree-An-Intuitive-Approach">GitHub Repo</a></strong></p>
<blockquote>
<h1 id="Monologue"><a href="#Monologue" class="headerlink" title="Monologue"></a><strong>Monologue</strong></h1></blockquote>
<p>I remember when the first time I studied <strong><code>Red Black Tree</code></strong> <strong>(RBT)</strong> , it was an enigma . A seemingly random <em>rotations</em> and <em>colorings</em> seems to somehow balance a <strong><code>Binary Search Tree</code></strong> <strong>(BST)</strong> . But I had no intuition for why these rotations and colorings seem to magically balance the BST . I used to read these horrible case works and my reaction everytime after it got balanced was - </p>
<p><img src="/images/RBTDrawings/Images/Pikachu.webp"></p>
<p>&nbsp;<br>I had no idea what the <strong><code>RED</code></strong> and <strong><code>BLACK</code></strong> node represents . I didn’t even understand why they exist in the first place . After all , what has coloring got to do with the balancing of a Binary Search Tree , right ? . And why are they even called Red and Black , why not any other colors (<em>the answer is hilarious XD</em>) . All in all , it was a giant <strong>black box</strong> . All these <code>Insert</code> and <code>Delete</code> cases , nothing properly made sense . The number of unanswered questions stacked up and up . So , I had to do something about it . After few weeks of <em>researching</em> (read <em><strong>googling</strong></em>) , scouring through the internet and with a bit of imagination , I think I finally got ahold of the answers to all the questions that my dumb brain was unable to grasp : ) . This writeup is to accumulate all these answers and make an intuitive approach to Red BLack Trees so that dumb people like me can also have a proper intuition for the underlying operations in Red Black Tree and so that you don’t have to go through all of these by yourself again . </p>
<p>&nbsp;<br>You might never need to understand the underlying intuitions behind all the operations . You can just call <strong>stl</strong> <strong><code>map</code></strong> or <strong><code>set</code></strong> in <code>c++</code> and <strong><code>TreeMap</code></strong> in <code>java</code> , and can easily pass your life in peace . But if you do care for the intuition , <em>you are in for a ride</em> : D</p>
<blockquote>
<h1 id="The-Story-Begins"><a href="#The-Story-Begins" class="headerlink" title="The Story Begins"></a><strong>The Story Begins</strong></h1></blockquote>
<p>To properly understand anything one need to know its past . In my search for proper understanding of Red Black Trees , this is when it actually started to make sense to me for the first time . </p>
<p>I assume that you are familiar with Binary Search Trees and their shortcomings ( The complexity depends on tree height and in the worst case the height can be N , making most of the operations <strong><code>O(N)</code></strong> )</p>
<p>So , we need to somehow make it balanced such that on average the height is <strong><code>logN</code></strong> . Red Black Tree with it magic <code>rotations</code> and <code>colorings</code> seems to somehow do this . But this is not the only data structure to do this . <em>The key to understanding RBT lies on the first few variant of this data structure that attempted to solve this balance of BSTs</em>.</p>
<h2 id="A-slightly-modified-BST"><a href="#A-slightly-modified-BST" class="headerlink" title="A slightly modified BST"></a><strong>A slightly modified BST</strong></h2><p><img src="/images/RBTDrawings/Images/ModBST.png"></p>
<p>Let’s consider a slight variant of the <strong>BST</strong>. Instead of <strong>1 key</strong> per node as in the regular BST , we will store upto <strong>2 keys</strong> per node in this case and each node can have <strong>upto 3 child</strong> .</p>
<p>That’s it ! No other difference .</p>
<p>Now first consider <strong>insertion</strong> in this tree . How will we insert a node ?<br>&nbsp;<br>The idea is almost identical to regular BST . We compare the key wih the one in the tree and decide to go left , right or <strong>middle</strong> . Yes , the middle part is the only new thing here . This addition of new option is not hard to see why , since there can be 2 keys per node , the number of paths to take will be 3 of course !<br>&nbsp;<br>Now , what happens when  we find the position for insertion key . If adding this key doesn’t change the property that we assumed (atmost 2 keys per node) , we can just easily add it ! </p>
<ul>
<li><p><strong>When can we just add it without any concern ?</strong><br>If we find that there is only 1 key , then we can just add another key and our tree properties will be perfectly fine !</p>
<p> <img src="/images/RBTDrawings/Images/ModInsert1.png"></p>
<p> <img src="/images/RBTDrawings/Images/ModInsert2.png"></p>
</li>
</ul>
<ul>
<li><p><strong>When does problem arise ?</strong><br>The problematic case : we find the corresponding place for insertion and we insert it . If after insertion we see there are 3 keys , we are in trouble : ( As mentioned earlier , there can be atmost 2 keys per node . So , we need to somehow fix this unstable node . Otherwise we are doomed . Here is an example .</p>
<p>  <img src="/images/RBTDrawings/Images/ModInsert3.png"></p>
<p>  <img src="/images/RBTDrawings/Images/ModInsert4.png"></p>
</li>
</ul>
<p>Now that we are stuck , it’s not hard no find a way around in this tree . We see that <code>18</code> is sitting lonely out there and has a place for one extra friend . We push up the middle key of the unstable node and voila we are good again . There are no more 3 key node in this tree . </p>
<p>Nice save : D   </p>
<p>Now if you have <em>good observation</em> , you might have observed that <em>all the leaf nodes have same distance from the root</em> . This is not just a coincidence . Let’s see why this is the case .<br>&nbsp;<br> We have seen 2 different type of insertions so far and if you noticed , none of them changed the height of the tree . Now let’s consider a case where the push up is such that there is an increase of height . </p>
<p><img src="/images/RBTDrawings/Images/ModInsert6.PNG"></p>
<p><img src="/images/RBTDrawings/Images/ModInsert7.PNG"></p>
<p><img src="/images/RBTDrawings/Images/ModInsert8.PNG"></p>
<p><img src="/images/RBTDrawings/Images/ModInsert9.PNG"></p>
<p> Did you see what just happened ? The height of the tree increased by 1 and the distance of all the leaf nodes increased exactly by 1 . Thus leading to having all the leaf nodes in the same height/depth .</p>
<h3 id="Key-Takeaway-from-slightly-modified-BST"><a href="#Key-Takeaway-from-slightly-modified-BST" class="headerlink" title="Key Takeaway from slightly modified BST"></a><strong>Key Takeaway from slightly modified BST</strong></h3><p> We saw earlier that if there was a way to balance our BST , we can efficiently do operations . Our slightly modified BST does exactly that ! We just saw that our tree is always perfectly balanced !<br> In this slightly modified BST , </p>
<ul>
<li><strong>Worst Case Height</strong> : <strong><code>O(log_base2_N)</code></strong> / <strong><code>O(logN)</code></strong> (All nodes have 2 keys)</li>
<li><strong>Best Case Height</strong> : <strong><code>O(log_base3_N)</code></strong> (All nodes have 3 keys)</li>
</ul>
<h2 id="Modifying-one-step-further"><a href="#Modifying-one-step-further" class="headerlink" title="Modifying one step further"></a><strong>Modifying one step further</strong></h2><p>This time we will allow upto 3 keys per node . One more than the last time . This time there is also one problematic case : when we  have 4 keys per node . We also do almost the same thing we did the last time . When there is a potential 4 key node , we split to make room for the new key .</p>
<p>I will just show an example and won’t dive deep .</p>
<p><img src="/images/RBTDrawings/Images/DoubleModInsert1.png"></p>
<p><img src="/images/RBTDrawings/Images/DoubleModInsert2.png"></p>
<p><img src="/images/RBTDrawings/Images/DoubleModInsert3.png"></p>
<p><img src="/images/RBTDrawings/Images/DoubleModInsert4.png"></p>
<p>&nbsp;</p>
<blockquote>
<h1 id="Changing-Vantage-Point"><a href="#Changing-Vantage-Point" class="headerlink" title="Changing Vantage Point"></a><strong>Changing Vantage Point</strong></h1></blockquote>
<p>Simulating this tree seems to be very easy in hand . But coding up this is not . Maintains variable number of keys in a node and also handling tree splitting can be a cumbersome job to do . If you are a lazy guy like me you wouldn’t dare to implement this .</p>
<p>&nbsp;<br>Now , let’s change our vantage point . Let’s cleverly represent this nodes so that we don’t have to deal with all these tree splitting and variable nodes .</p>
<p>&nbsp;<br>With a bit of imagination , we can think the 2 key nodes as 2 separate nodes glued together by an edge . If we draw this link by leaning on the side a bit , you can see that it is just your familiar BST .</p>
<p>&nbsp;<br>But wait ! How do you distinguish between an <strong>ordinary edge</strong> and a <strong>glue edge</strong> . Yes ! we color it : D </p>
<p>Here’s how we can represent the <strong><code>2 key nodes</code></strong> :</p>
<p><img src="/images/RBTDrawings/Images/GlueEdge1.png"></p>
<p>And here’s how we can represent the <strong><code>3 key nodes</code></strong> :</p>
<p><img src="/images/RBTDrawings/Images/GlueEdge2.png"></p>
<p>We can also instead color children nodes thus making it convenient to implement as tracking edge colors in BST implementation would not be a headache anymore .</p>
<p><img src="/images/RBTDrawings/Images/GlueEdge3.png"> </p>
<p>This was the eureka moment for me ! This is the <strong>Red Black Tree</strong> we have studied blindly all this time ! Finally we figured out the <strong><code>coloring</code></strong> ! RBT is nothing but a fancy way of representing the modified BSTs we saw earlier . Isn’t this great ? : D </p>
<p><img src="/images/RBTDrawings/Images/meme.jpg"></p>
<p>Now you ask , why is this red ? Why not any other colors ?</p>
<details>
<summary>
Answer
</summary>

<p>It was because the guys who invented this , only had red and black pens to draw :v And they chose to color the nodes red .</p>
</details>

<p>&nbsp;</p>
<blockquote>
<h1 id="Inside-the-Black-Box"><a href="#Inside-the-Black-Box" class="headerlink" title="Inside the Black Box"></a><strong>Inside the Black Box</strong></h1></blockquote>
<h2 id="Insert"><a href="#Insert" class="headerlink" title="Insert"></a><strong>Insert</strong></h2><p>Now , we know that the operations we saw till now was RBT under the hood . Let’s see how these operations look in the RBT .</p>
<p><img src="/images/RBTDrawings/Images/RBTInsert1.png"></p>
<p><img src="/images/RBTDrawings/Images/RBTInsert2.png"></p>
<p><img src="/images/RBTDrawings/Images/RBTInsert4.png"></p>
<p>If you open a random book , you must have seen this weird rule which goes something like this : <em>when there are 2 red nodes in a row and uncle is also a red node , we do color flip</em> . <strong>Now you see what those color flip actually do !</strong> These is just <em>a fancy way to implement the splitting on the modified BST</em> .</p>
<p>Now , let’s see another type of insertion .</p>
<p><img src="/images/RBTDrawings/Images/RBTInsert5.png"></p>
<p><img src="/images/RBTDrawings/Images/RBTInsert6.png"></p>
<p><img src="/images/RBTDrawings/Images/RBTInsert7.png"></p>
<p>You might have also seen a rule which goes something like this : _when there are 2 red nodes in a row and uncle is a black node , we need to rotate to balance the RBT _. This is just a normal insertion in the modified BST ! This one has 2 case : the node could be red nodes could be in Left Right order unlike the Left left order shown in the last example . This is the same , we just do 2 rotations to come to our proper 3 key node representation .</p>
<h2 id="Delete"><a href="#Delete" class="headerlink" title="Delete"></a><strong>Delete</strong></h2><p>Insertion was pretty easy . Most of the books represent delete in RBT as an awful hard operation . Infact when I first read the deletion , it was just a bunch of messy casework to memorize and I had no idea what the heck we were actually doing . But now , it has changed . Deletion is not difficult than insertion in any way , if not easier !</p>
<p>&nbsp;<br>But , first let’s recap some RBT properties which can be easily seen from our modified BST analogy :</p>
<ul>
<li>In modified BST , all leaf nodes were at the same height . So , in our RBT all the subtrees will have same black height (remember how red nodes doesn’t contribute to the height , we just lean on either side to mimic BST)</li>
<li>Root is always black </li>
</ul>
<p>This 2 properties are enough to understand Deletion .</p>
<p>Deletion process is almost similar to the normal BST . I won’t dive deep . Here is a recap :</p>
<ul>
<li>If we have less than 2 child , we can delete this node</li>
<li>Otherwise , we replace with the successor / predecessor node and delete that node instead</li>
</ul>
<p>Now in case of RBT , there can be some violation . Let’s see :</p>
<ul>
<li>If we are deleting a red node , we are safe (Remember that we can easily delete from 2 key node in our slightly modified BST as it doesn’t affect the height of the tree)</li>
<li>But if we are deleting a black node , we are in trouble : (  Deleting a black node will violate the first property we have seen earlier . We gotta fix this . This is the whole fiasco is about .</li>
</ul>
<p>Let’s begin . Rather than telling you a bunch of awful rules to memorize , let us see what can and can’t be done intuitively . Let me walk you thorough -</p>
<p><strong>The Easy One</strong>  </p>
<p>&nbsp;<br>This time , the node we deleted has black sibling and no red children . Let see how it goes if we want to restore balance -</p>
<p><img src="/images/RBTDrawings/Images/Delete1.png"></p>
<p>The idea to solve this is we hand our problem to the parent . And if the parent couldn’t solve , then we repeat the same process . We know that it will be fixed some time in the future because we just saw in the case of parent being the root , our problem is solved <strong>immediately</strong> . </p>
<p><img src="/images/RBTDrawings/Images/Delete2.PNG"></p>
<p><strong>The Easier One</strong>  </p>
<p>&nbsp;<br>This time , the node we deleted has black sibling and at least one red children . Let’s see how this one goes -</p>
<p><img src="/images/RBTDrawings/Images/Delete3.PNG"></p>
<p>Pretty easy !</p>
<p>There is just one corner case , if the only red child was the right node in the example we just saw , we would have to do one more rotation (like we did in the insert) to make it like the one we solved .</p>
<p><strong>The Clever One</strong></p>
<p>We are almost done . We just need to take care of one last thing . The red sibling case - </p>
<p><img src="/images/RBTDrawings/Images/Delete4.PNG"></p>
<p>And now , we are done . See ! It was not that bad . Once we know why we are doing what , it immensely simplifies stuffs !</p>
<blockquote>
<h1 id="Getting-our-hands-dirty-with-code"><a href="#Getting-our-hands-dirty-with-code" class="headerlink" title="Getting our hands dirty (with code)"></a><strong>Getting our hands dirty (with code)</strong></h1></blockquote>
<p>All these efforts till now were all for this . We had to come up with glue nodes and colorings and what not just so that we can easily implement this thing . So , let’s get into it !</p>
<p>I remember when i first the RBT pseudocode from Cormen (CLRS) , I had a mini heart attack . My first reaction was , “ Eww, how can a code be this ugly ! “ And the impression hasn’t changed a bit . It is still one of the most ugliest implementation I’ve seen till date . Coding a red black tree doesn’t have to be this ugly .</p>
<p>Instead , I will guide you with a recursive implementation which I found much easier to code . Much much easier to debug and the size of the code will be half the size of the cormen implementation if not less . </p>
<h2 id="The-Node"><a href="#The-Node" class="headerlink" title="The Node"></a><strong>The Node</strong></h2><p>We need just one more information from our usual BST : Color . No need to track parent or any other things . And about <em>why we have taken a pointer array</em> , not 2 <code>left</code> <code>right</code> pointers , I will get to that in a second .</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> left 0</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> right 1</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span> data,color;</span><br><span class="line">    Node *child[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">Node</span>(<span class="keyword">int</span> data,<span class="keyword">int</span> color)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;data = data;</span><br><span class="line">        <span class="keyword">this</span>-&gt;color = color;</span><br><span class="line">        <span class="keyword">this</span>-&gt;child[left] = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">this</span>-&gt;child[right] = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="Auxiliary-Operations"><a href="#Auxiliary-Operations" class="headerlink" title="Auxiliary Operations"></a><strong>Auxiliary Operations</strong></h2><p>The main auxiliary operations are <strong><code>rotation</code></strong> and <strong><code>color flipping</code></strong> . The implementations are pretty much straightforward . If we had taken 2 separate pointers , the implementation would be like this </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">colorFlip</span><span class="params">(Node *node)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    node-&gt;color = node-&gt;color^<span class="number">1</span>;</span><br><span class="line">    node-&gt;left-&gt;color = node-&gt;left-&gt;color^<span class="number">1</span>;</span><br><span class="line">    node-&gt;right-&gt;color = node-&gt;right-&gt;color^<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Node* <span class="title">leftRotate</span><span class="params">(Node *node)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Node *temp = node-&gt;right;</span><br><span class="line">    node-&gt;right = temp-&gt;left;</span><br><span class="line">    temp-&gt;left = node;</span><br><span class="line"></span><br><span class="line">    temp-&gt;color = node-&gt;color;</span><br><span class="line">    node-&gt;color = RED;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Node* <span class="title">rightRotate</span><span class="params">(Node *node)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Node *temp = node-&gt;left;</span><br><span class="line">    node-&gt;left = temp-&gt;right;</span><br><span class="line">    temp-&gt;right = node;</span><br><span class="line"></span><br><span class="line">    temp-&gt;color = node-&gt;color;</span><br><span class="line">    node-&gt;color = RED;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>But , if instead we had implemented using <code>pointer array</code> , we can actually write only one function for the rotation ! </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Node* <span class="title">rotate</span><span class="params">(Node *node,<span class="keyword">bool</span> dir)</span> <span class="comment">/// direction : left / right</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Node *temp = node-&gt;child[!dir];</span><br><span class="line">    node-&gt;child[!dir] = temp-&gt;child[dir];</span><br><span class="line">    temp-&gt;child[dir] = node;</span><br><span class="line"></span><br><span class="line">    temp-&gt;color = node-&gt;color;</span><br><span class="line">    node-&gt;color = RED;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>And this way , our <code>double rotation</code> code is just 2 lines !</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Node* <span class="title">doubleRotate</span><span class="params">(Node *node,<span class="keyword">bool</span> dir)</span> <span class="comment">/// align reds  , then rotate</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    node-&gt;child[!dir] = <span class="built_in">rotate</span>(node-&gt;child[!dir],!dir);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">rotate</span>(node,dir);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We have already made our code half the size ! You will be amazed to see the magic of this further when we don’t have to seperately handle the mirror cases in insert and delete operation : D At least I was , when I found out this trick when scouring through the internet which dramatically reduced my original insert implementation .</p>
<p>Let’s get into insertion .</p>
<h2 id="Insert-1"><a href="#Insert-1" class="headerlink" title="Insert"></a><strong>Insert</strong></h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(<span class="keyword">int</span> data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    root = __insert(root,data);</span><br><span class="line">    root-&gt;color = BLACK;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Node* __insert(Node *node,<span class="keyword">int</span> data)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Node</span>(data,RED);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> dir = data &gt; node-&gt;data; <span class="comment">/// left -&gt; 0 , right -&gt; 1</span></span><br><span class="line"></span><br><span class="line">    node-&gt;child[dir] = __insert(node-&gt;child[dir],data);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">INSERT_FIX_UP</span>(node,dir);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>We just need to write this magic function <strong><code>INSERT_FIX_UP</code></strong> and we are done ! Iterative implementations needs to track parent and also handing all the cases can be really pain . But , we will take advantage of the bottom up approach . If a RBT property violation has occurred , we will fix on our way up in the recursion !</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Node* <span class="title">INSERT_FIX_UP</span><span class="params">(Node *node,<span class="keyword">bool</span> dir)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">red</span>(node-&gt;child[dir]))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/// case 1 : both child red =&gt; any one child has 2 reds in a row (LL LR RR RL) =&gt; flip colors</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">red</span>(node-&gt;child[!dir]))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">red</span>(node-&gt;child[dir]-&gt;child[dir]) || <span class="built_in">red</span>(node-&gt;child[dir]-&gt;child[!dir]))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">colorFlip</span>(node);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">/// case 2 : both child not red</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">red</span>(node-&gt;child[dir]-&gt;child[dir]))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">/// any one child has 2 reds in a row (LL RR) =&gt; rotate</span></span><br><span class="line">                node = <span class="built_in">rotate</span>(node,!dir);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">red</span>(node-&gt;child[dir]-&gt;child[!dir]))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">/// any one child has 2 reds in a row (LR RL) =&gt; align first , then rotate</span></span><br><span class="line">                node = <span class="built_in">doubleRotate</span>(node,!dir);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>See , how we don’t need to write code for additional <strong>mirror cases</strong> !</p>
<h2 id="Delete-1"><a href="#Delete-1" class="headerlink" title="Delete"></a><strong>Delete</strong></h2><p>The delete skeleton is the same as regular BST , with just one minor change . We keep a <strong><code>flag</code></strong> variable to keep track if we have already restored the balance or not . </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_</span><span class="params">(<span class="keyword">int</span> data)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ok = <span class="literal">false</span>;</span><br><span class="line">    root = __delete(root,data,ok);</span><br><span class="line">    <span class="keyword">if</span>(root!=<span class="literal">NULL</span>) root-&gt;color = BLACK;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Node* __delete(Node *node,<span class="keyword">int</span> data,<span class="keyword">bool</span> &amp;ok)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(node == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        ok = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// found the delete key</span></span><br><span class="line">    <span class="keyword">if</span>(node-&gt;data == data)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/// has one or less child</span></span><br><span class="line">        <span class="keyword">if</span>(node-&gt;child[left]==<span class="literal">NULL</span> || node-&gt;child[right]==<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Node* temp = <span class="literal">NULL</span>;</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;child[left]) temp = node-&gt;child[left];</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;child[right]) temp = node-&gt;child[right];</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">red</span>(node)) <span class="comment">/// the node is red =&gt; just delete it</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">free</span>(node);</span><br><span class="line">                ok = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">red</span>(temp)) <span class="comment">/// only child is red =&gt; replace with that red child and recolor black . so , black balance restored</span></span><br><span class="line">            &#123;</span><br><span class="line">                temp-&gt;color = BLACK;</span><br><span class="line">                <span class="built_in">free</span>(node);</span><br><span class="line">                ok = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="comment">/// has 2 child =&gt; replace with inorder predecessor / successor and recurse for that</span></span><br><span class="line">        &#123;</span><br><span class="line">            Node *temp = <span class="built_in">getMax</span>(node-&gt;child[left]); <span class="comment">/// inorder predecessor : maximum value in the left subtree</span></span><br><span class="line"></span><br><span class="line">            node-&gt;data = temp-&gt;data;</span><br><span class="line">            data = temp-&gt;data; <span class="comment">/// updating with predecessor data as this is the one to delete now</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">bool</span> dir = data &gt; node-&gt;data;</span><br><span class="line"></span><br><span class="line">    node-&gt;child[dir] = __delete(node-&gt;child[dir],data,ok); <span class="comment">/// recurse</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> ok ? node : <span class="built_in">DELETE_FIX_UP</span>(node,dir,ok);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Now , we have to write the magic function <strong><code>DELETE_FIX_UP</code></strong> .</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">Node* <span class="title">DELETE_FIX_UP</span><span class="params">(Node *node,<span class="keyword">bool</span> dir, <span class="keyword">bool</span> &amp;ok)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Node *parent = node; <span class="comment">/// saving for later red sibling fixing case</span></span><br><span class="line">    Node *sibling = node-&gt;child[!dir];</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Red Sibling Case =&gt; Reduce to Black Sibling Case</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">red</span>(sibling))</span><br><span class="line">    &#123;</span><br><span class="line">        node = <span class="built_in">rotate</span>(node,dir);</span><br><span class="line">        sibling = parent-&gt;child[!dir];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(sibling != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">/// Black Sibling Case , Part 1 : Black Sibling with only black children</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">red</span>(sibling-&gt;child[left]) &amp;&amp; !<span class="built_in">red</span>(sibling-&gt;child[right]))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">red</span>(parent)) ok = <span class="literal">true</span>; <span class="comment">/// will color it black and sibling subtree will not have imbalance</span></span><br><span class="line"></span><br><span class="line">            parent-&gt;color = BLACK; <span class="comment">/// if not ok , we proceed further</span></span><br><span class="line">            sibling-&gt;color = RED;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="comment">/// Black Sibling Case , Part 2 : Black Sibling with not red children</span></span><br><span class="line">        &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">int</span> initcol_parent = parent-&gt;color;</span><br><span class="line">            <span class="keyword">bool</span> isRedSiblingReduction = !(node==parent);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">red</span>(sibling-&gt;child[!dir])) <span class="comment">/// RR , LL</span></span><br><span class="line">            &#123;</span><br><span class="line">                parent = <span class="built_in">rotate</span>(parent,dir); <span class="comment">/// single rotation</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                parent = <span class="built_in">doubleRotate</span>(parent,dir); <span class="comment">/// align and rotate</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            parent-&gt;color = initcol_parent; <span class="comment">/// color will be the same as initial parent</span></span><br><span class="line">            parent-&gt;child[left]-&gt;color = BLACK;</span><br><span class="line">            parent-&gt;child[right]-&gt;color = BLACK;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(isRedSiblingReduction)</span><br><span class="line">            &#123;</span><br><span class="line">                node-&gt;child[dir] = parent; <span class="comment">/// fixing the child for proper bottom up fixing later</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                node = parent; <span class="comment">/// usual black case</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ok = <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Ah , we are done finally ! It was not that awful , was it ?</p>
<blockquote>
<h1 id="Optimization-and-Conclusion"><a href="#Optimization-and-Conclusion" class="headerlink" title="Optimization and Conclusion"></a><strong>Optimization and Conclusion</strong></h1></blockquote>
<p>If you have come this far down , let me tell you one more thing . The RBT we studied is the classical old RBT . There are other implementations of RBT which makes the code even more shorter and easier to write . Among these , one is <strong><code>Left Leaning Red Black Tree</code></strong> <strong>(LLRB)</strong> . It is nothing but the implementation of the <em>first modified BST</em> we saw . And about the implementation , we can also use a <strong><code>topdown approach</code></strong> , that is also easier to understand than the bottom up approach . If you do feel interested , check them out .</p>
<p>Congrats on reading this far : D If you have any problem , do let me know . And if you liked the writeup do let me know too !</p>
<blockquote>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a><strong>Reference</strong></h1><p>Ah! lot of them , I’m going to mention as many as I can remember.</p>
</blockquote>
<ul>
<li><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Red%E2%80%93black_tree?oldformat=true">https://en.wikipedia.org/wiki/Red%E2%80%93black_tree?oldformat=true</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cs.purdue.edu/homes/ayg/CS251/slides/chap13c.pdf">https://www.cs.purdue.edu/homes/ayg/CS251/slides/chap13c.pdf</a></li>
<li><a target="_blank" rel="noopener" href="http://smile.ee.ncku.edu.tw/old/Links/MTable/Course/DataStructure/2-3,2-3-4&red-blackTree_952.pdf">http://smile.ee.ncku.edu.tw/old/Links/MTable/Course/DataStructure/2-3,2-3-4&amp;red-blackTree_952.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/15455042/can-anyone-explain-the-deletion-of-left-lean-red-black-tree-clearly">https://stackoverflow.com/questions/15455042/can-anyone-explain-the-deletion-of-left-lean-red-black-tree-clearly</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf">https://www.cs.princeton.edu/~rs/talks/LLRB/LLRB.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/364616/in-red-black-trees-is-top-down-deletion-faster-and-more-space-efficient-than-bot/8024168#8024168">https://stackoverflow.com/questions/364616/in-red-black-trees-is-top-down-deletion-faster-and-more-space-efficient-than-bot/8024168#8024168</a></li>
<li><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=DQdMYevEyE4">https://www.youtube.com/watch?v=DQdMYevEyE4</a></li>
<li><a target="_blank" rel="noopener" href="https://eternallyconfuzzled.com/red-black-trees-c-the-most-common-balanced-binary-search-tree">https://eternallyconfuzzled.com/red-black-trees-c-the-most-common-balanced-binary-search-tree</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/14119995/red-black-tree-top-down-deletion-algorithm?rq=1">https://stackoverflow.com/questions/14119995/red-black-tree-top-down-deletion-algorithm?rq=1</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/13360369/deletion-in-left-leaning-red-black-trees">https://stackoverflow.com/questions/13360369/deletion-in-left-leaning-red-black-trees</a></li>
<li><a href="ftp://ftp.cs.princeton.edu/techreports/1985/006.pdf">ftp://ftp.cs.princeton.edu/techreports/1985/006.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://sites.cs.ucsb.edu/~teo/cs130a.m15/rbd.pdf">https://sites.cs.ucsb.edu/~teo/cs130a.m15/rbd.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/14119995/red-black-tree-top-down-deletion-algorithm">https://stackoverflow.com/questions/14119995/red-black-tree-top-down-deletion-algorithm</a></li>
<li><a target="_blank" rel="noopener" href="https://iq.opengenus.org/red-black-tree-deletion/">https://iq.opengenus.org/red-black-tree-deletion/</a></li>
<li><a target="_blank" rel="noopener" href="https://github.com/jeffrey-xiao/competitive-programming/blob/master/src/codebook/datastructures/RedBlackTree.java">https://github.com/jeffrey-xiao/competitive-programming/blob/master/src/codebook/datastructures/RedBlackTree.java</a></li>
<li><a target="_blank" rel="noopener" href="https://www.topcoder.com/community/competitive-programming/tutorials/an-introduction-to-binary-search-and-red-black-trees/">https://www.topcoder.com/community/competitive-programming/tutorials/an-introduction-to-binary-search-and-red-black-trees/</a></li>
<li><a target="_blank" rel="noopener" href="https://softwareengineering.stackexchange.com/questions/141834/how-is-a-java-reference-different-from-a-c-pointer">https://softwareengineering.stackexchange.com/questions/141834/how-is-a-java-reference-different-from-a-c-pointer</a></li>
<li><a target="_blank" rel="noopener" href="https://www.programiz.com/dsa/red-black-tree">https://www.programiz.com/dsa/red-black-tree</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cs.usfca.edu/~galles/visualization/RedBlack.html">https://www.cs.usfca.edu/~galles/visualization/RedBlack.html</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cs.princeton.edu/courses/archive/fall06/cos226/lectures/balanced.pdf">https://www.cs.princeton.edu/courses/archive/fall06/cos226/lectures/balanced.pdf</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cs.princeton.edu/courses/archive/spring19/cos226/lectures/33BalancedSearchTrees.pdf">https://www.cs.princeton.edu/courses/archive/spring19/cos226/lectures/33BalancedSearchTrees.pdf</a></li>
</ul>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/dummy/">Home</a></li>
         
          <li><a href="/dummy/archives/">Archive</a></li>
         
          <li><a href="https://zarif98sjs.github.io/">About Me</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Monologue"><span class="toc-number">1.</span> <span class="toc-text">Monologue</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Story-Begins"><span class="toc-number">2.</span> <span class="toc-text">The Story Begins</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A-slightly-modified-BST"><span class="toc-number">2.1.</span> <span class="toc-text">A slightly modified BST</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Key-Takeaway-from-slightly-modified-BST"><span class="toc-number">2.1.1.</span> <span class="toc-text">Key Takeaway from slightly modified BST</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Modifying-one-step-further"><span class="toc-number">2.2.</span> <span class="toc-text">Modifying one step further</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Changing-Vantage-Point"><span class="toc-number">3.</span> <span class="toc-text">Changing Vantage Point</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Inside-the-Black-Box"><span class="toc-number">4.</span> <span class="toc-text">Inside the Black Box</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Insert"><span class="toc-number">4.1.</span> <span class="toc-text">Insert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Delete"><span class="toc-number">4.2.</span> <span class="toc-text">Delete</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Getting-our-hands-dirty-with-code"><span class="toc-number">5.</span> <span class="toc-text">Getting our hands dirty (with code)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#The-Node"><span class="toc-number">5.1.</span> <span class="toc-text">The Node</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Auxiliary-Operations"><span class="toc-number">5.2.</span> <span class="toc-text">Auxiliary Operations</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Insert-1"><span class="toc-number">5.3.</span> <span class="toc-text">Insert</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Delete-1"><span class="toc-number">5.4.</span> <span class="toc-text">Delete</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Optimization-and-Conclusion"><span class="toc-number">6.</span> <span class="toc-text">Optimization and Conclusion</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Reference"><span class="toc-number">7.</span> <span class="toc-text">Reference</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zarif98sjs.github.io/dummy/RedBlackTree/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&text=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&is_video=false&description=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Red Black Tree : An Intuitive Approach (A Deep Dive)&body=Check out this article: https://zarif98sjs.github.io/dummy/RedBlackTree/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&title=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zarif98sjs.github.io/dummy/RedBlackTree/&name=Red Black Tree : An Intuitive Approach (A Deep Dive)&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zarif98sjs.github.io/dummy/RedBlackTree/&t=Red Black Tree : An Intuitive Approach (A Deep Dive)"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2019-2021
    Md. Zarif Ul Alam
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/dummy/">Home</a></li>
         
          <li><a href="/dummy/archives/">Archive</a></li>
         
          <li><a href="https://zarif98sjs.github.io/">About Me</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/dummy/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
