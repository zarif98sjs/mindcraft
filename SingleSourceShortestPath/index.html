<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="The ProblemGiven a source in a graph you have to find the shortest path to all other nodes . The Existence of Shortest PathThe shortest path exists when there is no negative weight cycle . This is pre">
<meta property="og:type" content="article">
<meta property="og:title" content="Single Source Shortest Path : A Deep Dive">
<meta property="og:url" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/index.html">
<meta property="og:site_name" content="MindCraft">
<meta property="og:description" content="The ProblemGiven a source in a graph you have to find the shortest path to all other nodes . The Existence of Shortest PathThe shortest path exists when there is no negative weight cycle . This is pre">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/Negavtive%20Cycle.png">
<meta property="og:image" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/Graph.png">
<meta property="og:image" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/Iteration%201.png">
<meta property="og:image" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/Iteration%202.png">
<meta property="og:image" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/Iteration%203.png">
<meta property="og:image" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/Worst%20Case.png">
<meta property="og:image" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/Dijkstra%20Fail.png">
<meta property="article:published_time" content="2020-07-02T00:00:00.000Z">
<meta property="article:modified_time" content="2021-04-26T19:58:51.554Z">
<meta property="article:author" content="Md. Zarif Ul Alam">
<meta property="article:tag" content="Algo, DS, Software &amp; What Not!">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/Negavtive%20Cycle.png">
    
    
      
        
          <link rel="shortcut icon" href="/dummy/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/dummy/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/dummy/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Single Source Shortest Path : A Deep Dive</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/dummy/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
		<script type="text/x-mathjax-config">
		  MathJax.Hub.Config({
			tex2jax: {
			  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
			  inlineMath: [['$','$']]
			}
		  });
		</script>
		<script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML' async></script>
	
<meta name="generator" content="Hexo 5.4.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" "Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/dummy/">Home</a></li>
         
          <li><a href="/dummy/archives/">Archive</a></li>
         
          <li><a href="https://zarif98sjs.github.io/">About Me</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post " href="/dummy/NumberOfSubArrays/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post " href="/dummy/LightOj1314/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top " href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post " href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&text=Single Source Shortest Path : A Deep Dive"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&is_video=false&description=Single Source Shortest Path : A Deep Dive"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Single Source Shortest Path : A Deep Dive&body=Check out this article: https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&name=Single Source Shortest Path : A Deep Dive&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&t=Single Source Shortest Path : A Deep Dive"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Problem"><span class="toc-number">1.</span> <span class="toc-text">The Problem</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Existence-of-Shortest-Path"><span class="toc-number">2.</span> <span class="toc-text">The Existence of Shortest Path</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bruteforce"><span class="toc-number">3.</span> <span class="toc-text">Bruteforce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bellman-Ford-Algorithm"><span class="toc-number">4.</span> <span class="toc-text">Bellman Ford Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Edge-Relaxation"><span class="toc-number">4.1.</span> <span class="toc-text">Edge Relaxation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Complexity-Analysis"><span class="toc-number">4.2.</span> <span class="toc-text">Complexity Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Worst-Case-Behaviour"><span class="toc-number">4.3.</span> <span class="toc-text">Worst Case Behaviour</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Optimization-Idea-1"><span class="toc-number">4.4.</span> <span class="toc-text">Optimization Idea 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Optimization-Idea-2"><span class="toc-number">4.5.</span> <span class="toc-text">Optimization Idea 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Types-of-graphs-where-Bellman-Ford-gives-correct-result"><span class="toc-number">4.6.</span> <span class="toc-text">Types of graphs where Bellman Ford gives correct result</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dijkstra%E2%80%99s-Algorithm"><span class="toc-number">5.</span> <span class="toc-text">Dijkstra’s Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Complexity-Analysis-1"><span class="toc-number">5.1.</span> <span class="toc-text">Complexity Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Original-Dijkstra-Implementaion-O-V-2"><span class="toc-number">5.1.1.</span> <span class="toc-text">Original Dijkstra Implementaion : O(V^2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Efficient-Dijkstra-Implementaion-O-ElogV"><span class="toc-number">5.1.2.</span> <span class="toc-text">Efficient Dijkstra Implementaion : O(ElogV)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Most-Efficient-Dijkstra-Implementaion-O-VlogV"><span class="toc-number">5.1.3.</span> <span class="toc-text">Most Efficient Dijkstra Implementaion : O(VlogV)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Summary"><span class="toc-number">5.1.4.</span> <span class="toc-text">Summary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shortcomings"><span class="toc-number">5.2.</span> <span class="toc-text">Shortcomings</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modified-Dijkstra%E2%80%99s-Algorithm"><span class="toc-number">6.</span> <span class="toc-text">Modified Dijkstra’s Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Complexity-Analysis-2"><span class="toc-number">6.1.</span> <span class="toc-text">Complexity Analysis</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Special-Graphs-Already-Known-Algorithms"><span class="toc-number">7.</span> <span class="toc-text">Special Graphs | Already Known Algorithms</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Unit-Edged-Graph"><span class="toc-number">7.1.</span> <span class="toc-text">Unit Edged Graph</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tree"><span class="toc-number">7.2.</span> <span class="toc-text">Tree</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DAG-Directed-Acyclic-Graph"><span class="toc-number">7.3.</span> <span class="toc-text">DAG (Directed Acyclic Graph)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Complexity"><span class="toc-number">7.3.1.</span> <span class="toc-text">Complexity</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Single Source Shortest Path : A Deep Dive
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Md. Zarif Ul Alam</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2020-07-02T00:00:00.000Z" itemprop="datePublished">2020-07-02</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/dummy/categories/Algorithm/">Algorithm</a> › <a class="category-link" href="/dummy/categories/Algorithm/Deep-Dive/">Deep Dive</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/dummy/tags/Algo-DS-Software-What-Not/" rel="tag">Algo, DS, Software & What Not!</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h1 id="The-Problem"><a href="#The-Problem" class="headerlink" title="The Problem"></a><strong>The Problem</strong></h1><p>Given a source in a graph you have to find the shortest path to all other nodes .</p>
<h1 id="The-Existence-of-Shortest-Path"><a href="#The-Existence-of-Shortest-Path" class="headerlink" title="The Existence of Shortest Path"></a><strong>The Existence of Shortest Path</strong></h1><p>The shortest path exists when there is no negative weight cycle . This is pretty much intuitive . Whenever there is a negative weight cycle we can traverse that cycle and our shortest path will decrease . We can do that infinite amount of times .<br>Thus leads to having no shortest path .</p>
<p><img src="/dummy/SingleSourceShortestPath/Negavtive%20Cycle.png"></p>
<h1 id="Bruteforce"><a href="#Bruteforce" class="headerlink" title="Bruteforce"></a><strong>Bruteforce</strong></h1><p>If we were to solve this by bruteforce , we can use BFS for every possible path to a node and take the shortest one . </p>
<p><strong>Complexity</strong> : <code>O( number of paths * (E + V) )</code></p>
<p>Now , the number of paths can be exponential . So , we can not solve this problem efficiently </p>
<h1 id="Bellman-Ford-Algorithm"><a href="#Bellman-Ford-Algorithm" class="headerlink" title="Bellman Ford Algorithm"></a><strong>Bellman Ford Algorithm</strong></h1><p>Bellman and Ford were the first few persons to tackle this problem . The Algorithm uses 2 simple facts :</p>
<ul>
<li>The shortest path is always a simple path</li>
<li>The shortest simple path to any node contains at most <code>n</code> nodes connected by <code>n-1</code> edges</li>
</ul>
<p>Using these 2 simple facts they devised the algorithm . The pseudocode is as folows :</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> iteration <span class="number">1</span> to n-<span class="number">1</span><span class="symbol">:</span></span><br><span class="line">    relax all edges u-&gt;v </span><br></pre></td></tr></table></figure>

<p>Now , what is this <em>edge relaxation</em> and why are we doing this relaxation <code>n-1</code> times ? Let’s see why </p>
<h2 id="Edge-Relaxation"><a href="#Edge-Relaxation" class="headerlink" title="Edge Relaxation"></a><strong>Edge Relaxation</strong></h2><p>The main operation for all shortest path finding algorithms is this edge relaxation process . The main idea is , if in the current stage of the algorithm we have the opportunity to shorten the shortest path to a node , we do that .</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">relax(u,v) <span class="symbol">:</span></span><br><span class="line">    <span class="keyword">if</span> Distance[u] + weight(u,v) &lt; Distance[v] : <span class="comment"># the path can be shortened</span></span><br><span class="line">        Distance[v] = Distance[u] + weight(u,v) <span class="comment"># relaxing the edge</span></span><br></pre></td></tr></table></figure>

<p>Now , why are we doing this <code>n-1</code> times for each edge ? </p>
<p>After we relax an edge the shortest path to that vertex is <code>length of the shortest path of the vertex that relaxed the edge + 1</code> . Let’s see a simple example for better understanding :</p>
<p><img src="/dummy/SingleSourceShortestPath/Graph.png"></p>
<p>If we were to simulate Bellman Ford Algorithm on this graph ,</p>
<p><strong>Iteration 1</strong></p>
<p><img src="/dummy/SingleSourceShortestPath/Iteration%201.png"></p>
<p>We relaxed <code>s -&gt; a</code> and <code>s -&gt; c</code> . Our shortest path to <code>a</code> and <code>c</code> increased to 1 . </p>
<p><strong>Iteration 2</strong></p>
<p><img src="/dummy/SingleSourceShortestPath/Iteration%202.png"></p>
<p>We relaxed <code>a -&gt; b</code> . So shortest path to <code>b</code> is now <code>2</code> .</p>
<p><strong>Iteration 3</strong></p>
<p><img src="/dummy/SingleSourceShortestPath/Iteration%203.png"></p>
<p>We can further relax <code>b -&gt; c</code> . Now the shortes path to <code>c</code> increased to <code>3</code> .</p>
<p>Now , we can clearly see why are doing the iteration <code>n-1</code> times . For a shortest path to exist to any node it can not have a path containing more than <code>n-1</code> edges .<br>We can clearly see fro the simulation , after <code>ith</code> iteration we get the shortest path with atmost <code>i</code> edges . That’s why we are doing this relaxation step <code>n-1</code> times .</p>
<h2 id="Complexity-Analysis"><a href="#Complexity-Analysis" class="headerlink" title="Complexity Analysis"></a><strong>Complexity Analysis</strong></h2><p>Complexity is pretty much straighforward : <code>O( V * E )</code></p>
<h2 id="Worst-Case-Behaviour"><a href="#Worst-Case-Behaviour" class="headerlink" title="Worst Case Behaviour"></a><strong>Worst Case Behaviour</strong></h2><p><img src="/dummy/SingleSourceShortestPath/Worst%20Case.png"></p>
<p>Edges are in the list in worst order<br><code>3 -&gt; 4</code> , <code>2 -&gt; 3</code> , <code>1 -&gt; 2</code> , <code>0 -&gt; 1</code></p>
<p>Can you think of any way to optimize Bellman Ford’s Algorithm ?</p>
<h2 id="Optimization-Idea-1"><a href="#Optimization-Idea-1" class="headerlink" title="Optimization Idea 1"></a><strong>Optimization Idea 1</strong></h2><p>If during the current step no edge is relaxed , then we have found the shortest path to all the nodes as in the next iteration nothing will improve as there simply is <em>no candidate to improve</em> .<br>So , if no relaxation is made we can terminate . The worst case complexity remains same .</p>
<h2 id="Optimization-Idea-2"><a href="#Optimization-Idea-2" class="headerlink" title="Optimization Idea 2"></a><strong>Optimization Idea 2</strong></h2><p>I think you have already noticed in that small simulation we are not relaxing all the edges in the current iteration . So , if we were able to <em>keep track</em> of the elements that are <strong>potential candidate to improve their neighbors</strong> we are in luck of optimizing the algorithm . We can modify the Bellman Ford Algorithm using a <strong>queue</strong> to do that . It is more like a <em><strong>modified BFS</strong></em> . We will also use adjacency list representation to improve the runtime .</p>
<h2 id="Types-of-graphs-where-Bellman-Ford-gives-correct-result"><a href="#Types-of-graphs-where-Bellman-Ford-gives-correct-result" class="headerlink" title="Types of graphs where Bellman Ford gives correct result"></a><strong>Types of graphs where Bellman Ford gives correct result</strong></h2><p>Given that a shortest path exist , Bellman Ford always gives the correct result . It is one of it’s advantage .</p>
<p>&nbsp;</p>
<h1 id="Dijkstra’s-Algorithm"><a href="#Dijkstra’s-Algorithm" class="headerlink" title="Dijkstra’s Algorithm"></a><strong>Dijkstra’s Algorithm</strong></h1><p>Unlike <em><strong>Belman Ford’s SSSP Algo</strong></em> Dijkstra’s SSSP Algorithm doesn’t work on graphs with negative edge weights . Apart from that Dijkstra’s Algorithm is much faster in graphs in most real life scenerio where weights are usually distance or time .     </p>
<p>The Algorithm uses a simple greedy apraoch . The idea is as follows :</p>
<ul>
<li>maintain a set of nodes where the algorithm has already determined the shortest path </li>
<li>from the explored set of nodes find the one with minimum distance, relax adjacent edges</li>
</ul>
<p>The pseudocode is as follows :</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="number">1</span> to number_of_nodes : </span><br><span class="line">    distance[i] = INF</span><br><span class="line"></span><br><span class="line">distance[source] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">populate all the &#123;distance[node],node&#125; pairs <span class="keyword">in</span> a data structure</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> the data structure is <span class="keyword">not</span> empty <span class="symbol">:</span></span><br><span class="line">    u = the node with minimum distance</span><br><span class="line">    extract(u)</span><br><span class="line">    <span class="keyword">for</span> every v <span class="keyword">in</span> neghborhood of u <span class="symbol">:</span></span><br><span class="line">        relax edges u-&gt;v</span><br></pre></td></tr></table></figure>
<p>&nbsp;</p>
<h2 id="Complexity-Analysis-1"><a href="#Complexity-Analysis-1" class="headerlink" title="Complexity Analysis"></a><strong>Complexity Analysis</strong></h2><p>&nbsp;</p>
<h3 id="Original-Dijkstra-Implementaion-O-V-2"><a href="#Original-Dijkstra-Implementaion-O-V-2" class="headerlink" title="Original Dijkstra Implementaion : O(V^2)"></a><strong>Original Dijkstra Implementaion</strong> : <strong><code>O(V^2)</code></strong></h3><p>Uses <strong>Array</strong> as the data structure . </p>
<ul>
<li><em>Initialize distances</em> : <code>O(V)</code></li>
<li><em>Populate Data Structure</em> : <code>O(V)</code></li>
<li><em>Extract Min</em> : for each node <code>O(V)</code> . Across all nodes <code>O(V^2)</code></li>
<li><em>Adjacency list update</em> : across all nodes atmost <strong>E</strong> updates , Each update is <code>O(1)</code> . So , Across all nodes <code>O(E)</code>   </li>
</ul>
<p>So , overall complexity : <code>O(V^2)</code></p>
<p>&nbsp;</p>
<h3 id="Efficient-Dijkstra-Implementaion-O-ElogV"><a href="#Efficient-Dijkstra-Implementaion-O-ElogV" class="headerlink" title="Efficient Dijkstra Implementaion : O(ElogV)"></a><strong>Efficient Dijkstra Implementaion</strong> : <strong><code>O(ElogV)</code></strong></h3><p>Uses <strong>Binary Heap</strong> as the data structure . </p>
<ul>
<li><em>Initialize distances</em> : <code>O(V)</code></li>
<li><em>Populate Data Structure</em> : Build Heap <code>O(V)</code> </li>
<li><em>Extract Min</em> : Find min <code>O(1)</code> and Delete Min (heapify) <code>O(logV)</code> . So for each node <code>O(logV)</code> and Across all nodes <code>O(VlogV)</code></li>
<li><em>Adjacency list update</em> : across all nodes atmost <strong>E</strong> decrease key updates , Each update is <code>O(logV)</code> . So , Across all nodes <code>O(ElogV)</code>   </li>
</ul>
<p>So , complexity : <code>O( VlogV + ElogV )</code> = <code>O(ElogV)</code></p>
<p>&nbsp;</p>
<h3 id="Most-Efficient-Dijkstra-Implementaion-O-VlogV"><a href="#Most-Efficient-Dijkstra-Implementaion-O-VlogV" class="headerlink" title="Most Efficient Dijkstra Implementaion : O(VlogV)"></a><strong>Most Efficient Dijkstra Implementaion</strong> : <strong><code>O(VlogV)</code></strong></h3><p>Uses <strong>Fibonacci Heap</strong> as the data structure . </p>
<ul>
<li><em>Initialize distances</em> : <code>O(V)</code></li>
<li><em>Populate Data Structure</em> : Build Heap <code>O(V)</code> </li>
<li><em>Extract Min</em> : Find min <code>O(1)</code> and Delete Min <code>O(logV)</code> . So for each node <code>O(logV)</code> and Across all nodes <code>O(VlogV)</code></li>
<li><em>Adjacency list update</em> : across all nodes atmost <strong>E</strong> decrease key updates , Each update is <code>O(1)</code> . So , Across all nodes <code>O(E)</code>   </li>
</ul>
<p>So , complexity : <code>O( VlogV + E)</code> = <code>O(VlogV)</code></p>
<p>&nbsp;</p>
<h3 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a><strong>Summary</strong></h3><p>&nbsp;</p>
<table>
<thead>
<tr>
<th></th>
<th>Initialize</th>
<th>Populate</th>
<th>Extract Min</th>
<th>Adjacency List Update</th>
<th>Total Complexity</th>
</tr>
</thead>
<tbody><tr>
<td>Array</td>
<td><code>O(V)</code></td>
<td><code>O(V)</code></td>
<td><code>O(V^2)</code></td>
<td><code>O(E)</code></td>
<td><strong><code>O(V^2)</code></strong></td>
</tr>
<tr>
<td>Binary Heap</td>
<td><code>O(V)</code></td>
<td><code>O(V)</code></td>
<td><code>O(VlogV)</code></td>
<td><code>O(ElogV)</code></td>
<td><strong><code>O(ElogV)</code></strong></td>
</tr>
<tr>
<td>Fibonacci Heap</td>
<td><code>O(V)</code></td>
<td><code>O(V)</code></td>
<td><code>O(VlogV)</code></td>
<td><code>O(E)</code></td>
<td><strong><code>O(VlogV)</code></strong></td>
</tr>
</tbody></table>
<p>&nbsp;</p>
<h2 id="Shortcomings"><a href="#Shortcomings" class="headerlink" title="Shortcomings"></a><strong>Shortcomings</strong></h2><p>Dijkstra’s Algorithm can fail on graphs with <em><strong>negative weights</strong>_ . Because of the greedy approach we take , whenever we are done processing a node by extracting , we have found the _<strong>optimal subpath</strong></em> for that node . But if a graph has negative weights , latter is not true .</p>
<p>Here is an example :</p>
<p><img src="/dummy/SingleSourceShortestPath/Dijkstra%20Fail.png"></p>
<p>Try simulating to see why Dijkstra fails in this case and also for which vertex .</p>
<p>&nbsp;</p>
<h1 id="Modified-Dijkstra’s-Algorithm"><a href="#Modified-Dijkstra’s-Algorithm" class="headerlink" title="Modified Dijkstra’s Algorithm"></a><strong>Modified Dijkstra’s Algorithm</strong></h1><p>Modified Dijkstra’s Algorithm <del>does not</del> works on negative weighted graph .</p>
<p>The idea is as follows :</p>
<ul>
<li>Instead of pre populating the heap , we start from source and each time take the one with minimum distance </li>
<li>Relax the adjacent edges of the chosen node and if the edge is able to minimize the distance we again insert the minimized node .</li>
</ul>
<p>The pseudocode is as follows : </p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="number">1</span> to number_of_nodes : </span><br><span class="line">    distance[i] = INF</span><br><span class="line"></span><br><span class="line">distance[source] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">insert &#123;distance[source],source&#125; <span class="keyword">in</span> heap</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> heap is <span class="keyword">not</span> empty <span class="symbol">:</span></span><br><span class="line">    u = the node with minimum distance</span><br><span class="line">    extract(u)</span><br><span class="line">    <span class="keyword">for</span> every v <span class="keyword">in</span> neghborhood of u <span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> edge u-&gt;v relaxed <span class="symbol">:</span></span><br><span class="line">            insert &#123;distance[v],v&#125; <span class="keyword">in</span> heap</span><br></pre></td></tr></table></figure>

<p>In the implementation , we use a trick called <strong>Lazy Update</strong> . We leave the outdated bigger valued weights in the Heap as it is instead of deleting it . As the next time we encounter this node we will surely meet the one with the smaller weight first </p>
<h2 id="Complexity-Analysis-2"><a href="#Complexity-Analysis-2" class="headerlink" title="Complexity Analysis"></a><strong>Complexity Analysis</strong></h2><p>For non negative weighted graph , the complexity is the same as the original Dijkstra .</p>
<p>As for the graphs with negative weights . It is tough to assign a proper upperbound as it is possible to design graphs with exponential number of operations .</p>
<h1 id="Special-Graphs-Already-Known-Algorithms"><a href="#Special-Graphs-Already-Known-Algorithms" class="headerlink" title="Special Graphs | Already Known Algorithms"></a><strong>Special Graphs | Already Known Algorithms</strong></h1><h2 id="Unit-Edged-Graph"><a href="#Unit-Edged-Graph" class="headerlink" title="Unit Edged Graph"></a><strong>Unit Edged Graph</strong></h2><p>A simple <strong>BFS</strong> is sufficient</p>
<p><em>Can you see why ?</em></p>
<details>
<summary>
Answer
</summary>

<p>If all edges have weight 1 , it is easy to see that shortest path is nothing but the <strong>level</strong> of the node</p>
</details>

<h2 id="Tree"><a href="#Tree" class="headerlink" title="Tree"></a><strong>Tree</strong></h2><p>The tree can be <strong>weighted/unweughted</strong> . A simple <strong>BFS/DFS</strong> is sufficient .</p>
<p><em>Can you see why ?</em></p>
<details>
<summary>
Answer
</summary>

<p>In a tree , there is only one path from one node to another . So , the distance from the source is indeed the shortest distance . </p>
</details>

<h2 id="DAG-Directed-Acyclic-Graph"><a href="#DAG-Directed-Acyclic-Graph" class="headerlink" title="DAG (Directed Acyclic Graph)"></a><strong>DAG (Directed Acyclic Graph)</strong></h2><p>If you noticed the 2nd Bellman Ford Optimization , we can reduce the complexity of the shortest path algorithm by cleverly choosing edges to update . </p>
<p>For a DAG , if we find the <strong>topsort</strong> order and process the edge relaxation in that order , we will always go in the optimized direction as topsort guarantees that .</p>
<p>The pseudocode is as follows :</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">order = Topsort(graph)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> order is <span class="keyword">not</span> empty <span class="symbol">:</span></span><br><span class="line">    u = front element of order</span><br><span class="line">    Extract(u)</span><br><span class="line">    <span class="keyword">for</span> every v <span class="keyword">in</span> neghborhood of u <span class="symbol">:</span></span><br><span class="line">        relax edges u-&gt;v</span><br></pre></td></tr></table></figure>
<p>Works on <strong>negative edge weighted</strong> graph also .</p>
<h3 id="Complexity"><a href="#Complexity" class="headerlink" title="Complexity"></a><strong>Complexity</strong></h3><p><em>Topsort</em> : <code>O(V+E)</code><br><em>Edge Relaxation in Topsort Order</em> : <code>O(E)</code><br>So , Complexity : <strong><code>O(V+E)</code></strong></p>

  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/dummy/">Home</a></li>
         
          <li><a href="/dummy/archives/">Archive</a></li>
         
          <li><a href="https://zarif98sjs.github.io/">About Me</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Problem"><span class="toc-number">1.</span> <span class="toc-text">The Problem</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#The-Existence-of-Shortest-Path"><span class="toc-number">2.</span> <span class="toc-text">The Existence of Shortest Path</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bruteforce"><span class="toc-number">3.</span> <span class="toc-text">Bruteforce</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Bellman-Ford-Algorithm"><span class="toc-number">4.</span> <span class="toc-text">Bellman Ford Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Edge-Relaxation"><span class="toc-number">4.1.</span> <span class="toc-text">Edge Relaxation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Complexity-Analysis"><span class="toc-number">4.2.</span> <span class="toc-text">Complexity Analysis</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Worst-Case-Behaviour"><span class="toc-number">4.3.</span> <span class="toc-text">Worst Case Behaviour</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Optimization-Idea-1"><span class="toc-number">4.4.</span> <span class="toc-text">Optimization Idea 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Optimization-Idea-2"><span class="toc-number">4.5.</span> <span class="toc-text">Optimization Idea 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Types-of-graphs-where-Bellman-Ford-gives-correct-result"><span class="toc-number">4.6.</span> <span class="toc-text">Types of graphs where Bellman Ford gives correct result</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Dijkstra%E2%80%99s-Algorithm"><span class="toc-number">5.</span> <span class="toc-text">Dijkstra’s Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Complexity-Analysis-1"><span class="toc-number">5.1.</span> <span class="toc-text">Complexity Analysis</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Original-Dijkstra-Implementaion-O-V-2"><span class="toc-number">5.1.1.</span> <span class="toc-text">Original Dijkstra Implementaion : O(V^2)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Efficient-Dijkstra-Implementaion-O-ElogV"><span class="toc-number">5.1.2.</span> <span class="toc-text">Efficient Dijkstra Implementaion : O(ElogV)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Most-Efficient-Dijkstra-Implementaion-O-VlogV"><span class="toc-number">5.1.3.</span> <span class="toc-text">Most Efficient Dijkstra Implementaion : O(VlogV)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Summary"><span class="toc-number">5.1.4.</span> <span class="toc-text">Summary</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Shortcomings"><span class="toc-number">5.2.</span> <span class="toc-text">Shortcomings</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Modified-Dijkstra%E2%80%99s-Algorithm"><span class="toc-number">6.</span> <span class="toc-text">Modified Dijkstra’s Algorithm</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Complexity-Analysis-2"><span class="toc-number">6.1.</span> <span class="toc-text">Complexity Analysis</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Special-Graphs-Already-Known-Algorithms"><span class="toc-number">7.</span> <span class="toc-text">Special Graphs | Already Known Algorithms</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Unit-Edged-Graph"><span class="toc-number">7.1.</span> <span class="toc-text">Unit Edged Graph</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Tree"><span class="toc-number">7.2.</span> <span class="toc-text">Tree</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DAG-Directed-Acyclic-Graph"><span class="toc-number">7.3.</span> <span class="toc-text">DAG (Directed Acyclic Graph)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Complexity"><span class="toc-number">7.3.1.</span> <span class="toc-text">Complexity</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&text=Single Source Shortest Path : A Deep Dive"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&is_video=false&description=Single Source Shortest Path : A Deep Dive"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Single Source Shortest Path : A Deep Dive&body=Check out this article: https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&title=Single Source Shortest Path : A Deep Dive"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&name=Single Source Shortest Path : A Deep Dive&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://zarif98sjs.github.io/dummy/SingleSourceShortestPath/&t=Single Source Shortest Path : A Deep Dive"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2019-2021
    Md. Zarif Ul Alam
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/dummy/">Home</a></li>
         
          <li><a href="/dummy/archives/">Archive</a></li>
         
          <li><a href="https://zarif98sjs.github.io/">About Me</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/dummy/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->


</body>
</html>
